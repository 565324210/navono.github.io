<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="google-site-verification" content="" />
  
  <title>ES6模块化</title>
  <meta name="author" content="Ping Qixing">
   <meta name="description" content="Coding with fun.">
  

  <meta property="og:title" content="ES6模块化"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:site_name" content="Ping"/>
 <meta property="og:image" content="undefined"/>
  
  <link href="/apple-touch-icon-precomposed.png" sizes="180x180" rel="apple-touch-icon-precomposed">
  <link rel="alternate" href="/atom.xml" title="Ping" type="application/atom+xml">
  <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/m.min.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>

<body>
  <a id="top"></a>
  <div id='wx_pic' style='display:none;'><img src='/wx_share.png'/></div>
  <div id="main">
    <div class="behind">
      <div class="back">
        <a href="/" class="black-color"><i class="fa fa-times" aria-hidden="true"></i></a>
      </div>
      <div class="description">
        &nbsp;虚妄
      </div>
    </div>
    <div class="container">
      

  <article class="standard post">
    <div class="title">
      
  
    <h1 class="page-title center">
        ES6模块化
    </h1>
  


    </div>
    <div class="meta center">
      
<time datetime="2017-08-12T18:29:20.000Z">
  <i class="fa fa-calendar"></i>&nbsp;
  2017-08-12
</time>



    
    &nbsp;
    <i class="fa fa-tag"></i>&nbsp;
    <a href="/categories/笔记/">笔记</a>




    
    &nbsp;
    <i class="fa fa-tag"></i>&nbsp;
    <a href="/tags/JavaScript/">JavaScript</a>


    </div>
    <hr>
    <div class="picture-container">
      
    </div>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#概括"><span class="toc-number">1.</span> <span class="toc-text">概括</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JavaScript中的模块化"><span class="toc-number">2.</span> <span class="toc-text">JavaScript中的模块化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ES5的模块化"><span class="toc-number">2.1.</span> <span class="toc-text">ES5的模块化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES6的模块化"><span class="toc-number">2.2.</span> <span class="toc-text">ES6的模块化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ES6模块化的基本知识"><span class="toc-number">3.</span> <span class="toc-text">ES6模块化的基本知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#默认导出"><span class="toc-number">3.1.</span> <span class="toc-text">默认导出</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#导出方式"><span class="toc-number">3.1.1.</span> <span class="toc-text">导出方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#import和export必须在文件顶部"><span class="toc-number">3.1.2.</span> <span class="toc-text">import和export必须在文件顶部</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#import会被提升"><span class="toc-number">3.1.3.</span> <span class="toc-text">import会被提升</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#import的东西在使用方被视为只读"><span class="toc-number">3.1.4.</span> <span class="toc-text">import的东西在使用方被视为只读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#支持循环依赖"><span class="toc-number">3.1.5.</span> <span class="toc-text">支持循环依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CommonJS中的循环依赖"><span class="toc-number">3.1.5.1.</span> <span class="toc-text">CommonJS中的循环依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ES6循环依赖"><span class="toc-number">3.1.5.2.</span> <span class="toc-text">ES6循环依赖</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#导入与导出"><span class="toc-number">4.</span> <span class="toc-text">导入与导出</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#导出风格"><span class="toc-number">4.1.</span> <span class="toc-text">导出风格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#所有导出风格"><span class="toc-number">4.2.</span> <span class="toc-text">所有导出风格</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#建议不要混用默认导出和具名导出"><span class="toc-number">4.2.1.</span> <span class="toc-text">建议不要混用默认导出和具名导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#默认导出只是另外一种具名导出"><span class="toc-number">4.2.2.</span> <span class="toc-text">默认导出只是另外一种具名导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#default可以作为导出的名字，但是不能作为变量名"><span class="toc-number">4.2.3.</span> <span class="toc-text">default可以作为导出的名字，但是不能作为变量名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#在使用方，导入的是视图"><span class="toc-number">4.3.</span> <span class="toc-text">在使用方，导入的是视图</span></a></li></ol></li></ol>
    <h1 id="概括"><a href="#概括" class="headerlink" title="概括"></a>概括</h1><p>JavaScript一直没有在语言层面支持代码的模块化，而是一直通过库来实现。ES6是第一次在标准在引入内建的模块化。</p>
<h1 id="JavaScript中的模块化"><a href="#JavaScript中的模块化" class="headerlink" title="JavaScript中的模块化"></a>JavaScript中的模块化</h1><p>ES6的模块块集成了之前已有的模块化的大部分有点，包括：</p>
<ul>
<li>每个模块都是加载后执行的代码块</li>
<li>在代码块中，其内的声明（变量声明，函数声明）满足：<ul>
<li>默认情况下，这些变量的作用域都只在模块内部。</li>
<li>可以在一些变量前加入export，将变量导出。</li>
</ul>
</li>
<li>一个模块可以从其他模块导入声明。有以下几种方式：<ul>
<li>通过相对路径（’../model/helpers’），文件后缀.js可以省略。</li>
<li>通过绝对路径（’/lib/js/healpers’），直接指向要导入的模块</li>
<li>通过命名方式（’util’），模块名指向的是一个已经配置的名字。</li>
</ul>
</li>
<li>模块都是单例的。即使一个模块导入了多次，只会有一个模块的“实例”存在。</li>
</ul>
<h2 id="ES5的模块化"><a href="#ES5的模块化" class="headerlink" title="ES5的模块化"></a>ES5的模块化</h2><p>ES5中存在两种模块化的方式，这两种方式是不兼容的。</p>
<ul>
<li>CommonJS 模块化。这个标准的主要实现者是Node.js（但是Node.js的模块化的一些特性要超越CommonJS），有以下特性：<ul>
<li>紧凑的语法</li>
<li>用于同步加载和服务器端</li>
</ul>
</li>
<li>Asynchronous Module Definition (AMD)。标准的实现主要是RequireJS，有以下特性：<ul>
<li>稍微复杂的语法，不需要eval()就能够使AMD工作</li>
<li>用于异步加载和浏览器端</li>
</ul>
</li>
</ul>
<h2 id="ES6的模块化"><a href="#ES6的模块化" class="headerlink" title="ES6的模块化"></a>ES6的模块化</h2><p>ES6模块化设计需要融合了上述两者的优点：</p>
<ul>
<li>和CommonJS一样有紧凑的语法，偏向于单导出和支持循环依赖</li>
<li>和AMD一样，可直接支持异步模式加载和可配置模式的模块加载</li>
</ul>
<p>但是同时ES6却要超越上述两者：</p>
<ul>
<li>支持语法比CommonJS更紧凑</li>
<li>支持静态分析（静态检测、优化等）</li>
<li>支持比CommonJS更好的循环依赖</li>
</ul>
<p>ES6模块化标准包括两个部分：</p>
<ul>
<li>声明式语法（导入和导出）</li>
<li>编程式的加载器API，用于配置模块如何加载和模块有条件地加载。</li>
</ul>
<h1 id="ES6模块化的基本知识"><a href="#ES6模块化的基本知识" class="headerlink" title="ES6模块化的基本知识"></a>ES6模块化的基本知识</h1><p>ES6支持两种方式的导出，可以同时使用，也可以独立使用，通常情况下是分开使用：</p>
<ul>
<li>多个命名的导出（一个模块多个导出）</li>
<li>单个默认的导出（一个模块一个导出）</li>
</ul>
<h2 id="默认导出"><a href="#默认导出" class="headerlink" title="默认导出"></a>默认导出</h2><h3 id="导出方式"><a href="#导出方式" class="headerlink" title="导出方式"></a>导出方式</h3><ul>
<li>导出标签式声明</li>
<li>直接导出 <em>默认导出(Default-exporting)</em> 值</li>
</ul>
<h3 id="import和export必须在文件顶部"><a href="#import和export必须在文件顶部" class="headerlink" title="import和export必须在文件顶部"></a>import和export必须在文件顶部</h3><p>因为ES6模块的结构是静态的，所以不能有条件地导入或者导出。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">Math</span>.random()) &#123;</span><br><span class="line">    <span class="keyword">import</span> <span class="string">'foo'</span>; <span class="comment">// SyntaxError</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// You can’t even nest `import` and `export`</span></span><br><span class="line"><span class="comment">// inside a simple block:</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">import</span> <span class="string">'foo'</span>; <span class="comment">// SyntaxError</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="import会被提升"><a href="#import会被提升" class="headerlink" title="import会被提升"></a>import会被提升</h3><p>下面的代码会被正确运行：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foo();</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="string">'my_module'</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="import的东西在使用方被视为只读"><a href="#import的东西在使用方被视为只读" class="headerlink" title="import的东西在使用方被视为只读"></a>import的东西在使用方被视为只读</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------ lib.js ------</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> counter = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">incCounter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    counter++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//------ main.js ------</span></span><br><span class="line"><span class="keyword">import</span> &#123; counter, incCounter &#125; <span class="keyword">from</span> <span class="string">'./lib'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The imported value `counter` is live</span></span><br><span class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 3</span></span><br><span class="line">incCounter();</span><br><span class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 4</span></span><br></pre></td></tr></table></figure>
<p>导入的东西被视为视图有以下好处：</p>
<ul>
<li>支持循环依赖，即使是非限定（unqualified ）的导入</li>
<li>限定（Qualified ）导入和非限定（支持循环依赖，即使是非限定（unqualified）导入以同样的方式运行</li>
<li>将代码切分到多个模块也可正常运行（只要不修改导出的值）</li>
</ul>
<h3 id="支持循环依赖"><a href="#支持循环依赖" class="headerlink" title="支持循环依赖"></a>支持循环依赖</h3><h4 id="CommonJS中的循环依赖"><a href="#CommonJS中的循环依赖" class="headerlink" title="CommonJS中的循环依赖"></a>CommonJS中的循环依赖</h4><p>TBD</p>
<h4 id="ES6循环依赖"><a href="#ES6循环依赖" class="headerlink" title="ES6循环依赖"></a>ES6循环依赖</h4><p>TBD</p>
<h1 id="导入与导出"><a href="#导入与导出" class="headerlink" title="导入与导出"></a>导入与导出</h1><h2 id="导出风格"><a href="#导出风格" class="headerlink" title="导出风格"></a>导出风格</h2><ul>
<li><p>默认导出</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> localName <span class="keyword">from</span> <span class="string">'src/my_lib'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>命名空间导出：已对象的方式导出模块</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> my_lib <span class="keyword">from</span> <span class="string">'src/my_lib'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>具名导出</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; name1, name2 &#125; <span class="keyword">from</span> <span class="string">'src/my_lib'</span>;</span><br></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// Renaming: import `name1` as `localName1`</span></span><br><span class="line"><span class="keyword">import</span> &#123; name1 <span class="keyword">as</span> localName1, name2 &#125; <span class="keyword">from</span> <span class="string">'src/my_lib'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Renaming: import the default export as `foo`</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> foo &#125; <span class="keyword">from</span> <span class="string">'src/my_lib'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>空导入。只加载模块，不导入任何东西。会执行模块的代码体</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'src/my_lib'</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>有两种方式来组合上述的导出：</p>
<ul>
<li><p>默认导出和命名空间导出的组合</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> theDefault, * <span class="keyword">as</span> my_lib <span class="keyword">from</span> <span class="string">'src/my_lib'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>默认导出和具名导出的组合</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">import</span> theDefault, &#123; name1, name2 &#125; <span class="keyword">from</span> <span class="string">'src/my_lib'</span>;</span><br><span class="line">  <span class="string">``</span><span class="string">` </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## 具名导出风格：inline vs. clause</span></span><br><span class="line"><span class="string">一种风格是在声明前直接加export关键字</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>js</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> myVar1 = ···;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> myVar2 = ···;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> MY_CONST = ···;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">myFunc</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    ···</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span>* <span class="title">myGeneratorFunc</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    ···</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    ···</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>另外一种是在模块的末尾同一导出：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MY_CONST = ···;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunc</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    ···</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; MY_CONST, myFunc &#125;;</span><br></pre></td></tr></table></figure></p>
<p>也可以以不同的名字导出：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; MY_CONST <span class="keyword">as</span> FOO, myFunc &#125;;</span><br></pre></td></tr></table></figure></p>
<h2 id="所有导出风格"><a href="#所有导出风格" class="headerlink" title="所有导出风格"></a>所有导出风格</h2><p>ES6支持一下几种导出风格：</p>
<ul>
<li><p>再导出</p>
<ul>
<li><p>再导出所有</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">'src/other_module'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过子句（clause）再导出</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; foo <span class="keyword">as</span> myFoo, bar &#125; <span class="keyword">from</span> <span class="string">'src/other_module'</span>;</span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> &#125; <span class="keyword">from</span> <span class="string">'src/other_module'</span>;</span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> foo &#125; <span class="keyword">from</span> <span class="string">'src/other_module'</span>;</span><br><span class="line"><span class="keyword">export</span> &#123; foo <span class="keyword">as</span> <span class="keyword">default</span> &#125; <span class="keyword">from</span> <span class="string">'src/other_module'</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>通过子句（clause）具名导出</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; MY_CONST <span class="keyword">as</span> FOO, myFunc &#125;;</span><br><span class="line"><span class="keyword">export</span> &#123; foo <span class="keyword">as</span> <span class="keyword">default</span> &#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>内联（inline）具名导出</p>
<ul>
<li><p>变量声明方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> foo;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> foo;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> foo;</span><br></pre></td></tr></table></figure>
</li>
<li><p>函数声明方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">myFunc</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span>* <span class="title">myGenFunc</span>(<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>类声明方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>默认导出</p>
<ul>
<li><p>函数声明方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">myFunc</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>* <span class="title">myGenFunc</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>类声明方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>表达式（注意分号）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> foo;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">'Hello world!'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="number">3</span> * <span class="number">7</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="建议不要混用默认导出和具名导出"><a href="#建议不要混用默认导出和具名导出" class="headerlink" title="建议不要混用默认导出和具名导出"></a>建议不要混用默认导出和具名导出</h3><h3 id="默认导出只是另外一种具名导出"><a href="#默认导出只是另外一种具名导出" class="headerlink" title="默认导出只是另外一种具名导出"></a>默认导出只是另外一种具名导出</h3><p>下面代码是等同的：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> foo &#125; <span class="keyword">from</span> <span class="string">'lib'</span>;</span><br><span class="line"><span class="keyword">import</span> foo <span class="keyword">from</span> <span class="string">'lib'</span>;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------ module1.js ------</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125; <span class="comment">// function declaration!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//------ module2.js ------</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">export</span> &#123; foo <span class="keyword">as</span> <span class="keyword">default</span> &#125;;</span><br></pre></td></tr></table></figure>
<h3 id="default可以作为导出的名字，但是不能作为变量名"><a href="#default可以作为导出的名字，但是不能作为变量名" class="headerlink" title="default可以作为导出的名字，但是不能作为变量名"></a>default可以作为导出的名字，但是不能作为变量名</h3><p>这就意味着default只能出现在别名导入的左边<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> foo &#125; <span class="keyword">from</span> <span class="string">'some_module'</span>;</span><br></pre></td></tr></table></figure></p>
<p>或则别名导出的右边：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; foo <span class="keyword">as</span> <span class="keyword">default</span> &#125;;</span><br></pre></td></tr></table></figure></p>
<p>或则再导出：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; myFunc <span class="keyword">as</span> <span class="keyword">default</span> &#125; <span class="keyword">from</span> <span class="string">'foo'</span>;</span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> otherFunc &#125; <span class="keyword">from</span> <span class="string">'foo'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The following two statements are equivalent:</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> &#125; <span class="keyword">from</span> <span class="string">'foo'</span>;</span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="keyword">default</span> &#125; <span class="keyword">from</span> <span class="string">'foo'</span>;</span><br></pre></td></tr></table></figure></p>
<h2 id="在使用方，导入的是视图"><a href="#在使用方，导入的是视图" class="headerlink" title="在使用方，导入的是视图"></a>在使用方，导入的是视图</h2><p>CommonJS和ES6导入方面有明显的不同：</p>
<ul>
<li>在CommonJS中，导入的值只是导出的一份拷贝</li>
<li>在ES6中，导入的值是导出值的一个只读视图</li>
</ul>
<p>CommonJS环境中：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------ lib.js ------</span></span><br><span class="line"><span class="keyword">var</span> counter = <span class="number">3</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">incCounter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    counter++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    counter: counter, <span class="comment">// (A)</span></span><br><span class="line">    incCounter: incCounter,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//------ main1.js ------</span></span><br><span class="line"><span class="keyword">var</span> counter = <span class="built_in">require</span>(<span class="string">'./lib'</span>).counter; <span class="comment">// (B)</span></span><br><span class="line"><span class="keyword">var</span> incCounter = <span class="built_in">require</span>(<span class="string">'./lib'</span>).incCounter;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The imported value is a (disconnected) copy of a copy</span></span><br><span class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 3</span></span><br><span class="line">incCounter();</span><br><span class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The imported value can be changed</span></span><br><span class="line">counter++;</span><br><span class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 4</span></span><br></pre></td></tr></table></figure></p>
<p>ES6环境中：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------ lib.js ------</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> counter = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">incCounter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    counter++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//------ main1.js ------</span></span><br><span class="line"><span class="keyword">import</span> &#123; counter, incCounter &#125; <span class="keyword">from</span> <span class="string">'./lib'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The imported value `counter` is live</span></span><br><span class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 3</span></span><br><span class="line">incCounter();</span><br><span class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The imported value can’t be changed</span></span><br><span class="line">counter++; <span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure></p>
<p>使用*导入也一样：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------ main2.js ------</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> lib <span class="keyword">from</span> <span class="string">'./lib'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The imported value `counter` is live</span></span><br><span class="line"><span class="built_in">console</span>.log(lib.counter); <span class="comment">// 3</span></span><br><span class="line">lib.incCounter();</span><br><span class="line"><span class="built_in">console</span>.log(lib.counter); <span class="comment">// 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The imported value can’t be changed</span></span><br><span class="line">lib.counter++; <span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure></p>
<p>但是有一点需要注意的是不能修改导入的对象，但是可以修改对象引用的属性。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------ lib.js ------</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//------ main.js ------</span></span><br><span class="line"><span class="keyword">import</span> &#123; obj &#125; <span class="keyword">from</span> <span class="string">'./lib'</span>;</span><br><span class="line"></span><br><span class="line">obj.prop = <span class="number">123</span>; <span class="comment">// OK</span></span><br><span class="line">obj = &#123;&#125;; <span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure></p>


  </article>
  </script>
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
  <div class="busuanzi center">
    页阅读量:&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;・&nbsp;
    站访问量:&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;・&nbsp;
    站访客数:&nbsp;<span id="busuanzi_value_site_uv"></span>
  </div>


<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = 'http://codingwith.me/2017/08/12/ES6模块化/index.html';
this.page.identifier = undefined;
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//navono.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



    </div>
  </div>
  <footer class="page-footer"><div class="clearfix">
</div>
<div class="right-foot container">
    <div class="firstrow">
        <a href="#top" target="_self">
        <i class="fa fa-arrow-right"></i>
        </a>
        Ping © 2017-2017
    </div>
    <div class="secondrow">
        <a href="https://github.com/gaoryrt/hexo-theme-pln">
        Theme Pln
        </a>
    </div>
</div>
<div class="clearfix">
</div>
</footer>
  <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<script src="/js/search.js"></script>
<script type="text/javascript">

// disqus scripts


// dropdown scripts
$(".dropdown").click(function(event) {
  var current = $(this);
  event.stopPropagation();
  $(current).children(".dropdown-content")[($(current).children(".dropdown-content").hasClass("open"))?'removeClass':'addClass']("open")
});
$(document).click(function(){
    $(".dropdown-content").removeClass("open");
})

var path = "/search.xml";
searchFunc(path, 'local-search-input', 'local-search-result');

</script>

</body>
</html>
